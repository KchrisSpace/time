<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            width: 100%;
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        h1 {
            text-align: center;
        }

        .container {
            display: flex;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .operation {
            flex: 1;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        .result {
            flex: 1;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        .operation label {
            display: block;
            margin: 10px 0 5px 0;
        }

        .operation input {
            margin-bottom: 15px;
        }

        .operation button {
            margin: 5px 5px 5px 0;
            padding: 8px 16px;
            cursor: pointer;
        }

        #resultArea {
            margin-top: 10px;
        }

        #resultArea .time-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin: 5px 0;
            background-color: #f5f5f5;
            border-radius: 4px;
        }

        #resultArea .time-text {
            flex: 1;
            font-size: 16px;
        }

        #resultArea .copy-btn {
            padding: 4px 12px;
            margin-left: 10px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            transition: background-color 0.3s;
        }

        #resultArea .copy-btn:hover {
            background-color: #45a049;
        }

        #resultArea .copy-btn:active {
            background-color: #3d8b40;
        }
    </style>
</head>

<body>
    <h1>随机时间</h1>

    <div class="container">
        <div class="operation">
            <h2>范围限制</h2>
            <label for="minTime">最小时间：</label>
            <!-- 只使用 input type="time"，用户只能输入两位小时和两位分钟 -->
            <input type="time" id="minTime" value="00:00">
            <br>
            <label for="maxTime">最大时间：</label>
            <input type="time" id="maxTime" value="23:59">
            <h2>随机时间</h2>

            <h2>操作</h2>
            <button id="randomButton">随机生成</button>
            <button id="resetButton">重置</button>
            <h2>数字范围限制</h2>
            <label for="minNumber">最小数字：</label>
            <input type="number" id="minNumber" value="0">
            <br>
            <label for="maxNumber">最大数字：</label>
            <input type="number" id="maxNumber" value="100">
            <h2>操作</h2>
            <button id="randomNumberButton">随机生成</button>
            <button id="resetNumberButton">重置</button>
        </div>
        <div class="result">
            <h2>生成结果</h2>
            <!-- 多次生成添加到这里 -->
            <div id="resultArea"></div>
        </div>
    </div>
    <script>
        const randomButton = document.getElementById('randomButton');
        const resetButton = document.getElementById('resetButton');
        const minTimeInput = document.getElementById('minTime');
        const maxTimeInput = document.getElementById('maxTime');
        const randomNumberButton = document.getElementById('randomNumberButton');
        const resetNumberButton = document.getElementById('resetNumberButton');
        const minNumberInput = document.getElementById('minNumber');
        const maxNumberInput = document.getElementById('maxNumber');
        const resultArea = document.getElementById('resultArea');

        function padZero(num) {
            return num.toString().padStart(2, '0');
        }

        // 解析 "HH:MM" 字符串为秒
        function timeStrToSeconds(timeStr) {
            const parts = timeStr.split(':');
            let h = 0, m = 0;
            if (parts.length >= 2) {
                h = parseInt(parts[0], 10) || 0;
                m = parseInt(parts[1], 10) || 0;
            }
            return h * 3600 + m * 60;
        }

        // 秒转为 {h, m, s}
        function secondsToHMS(totalSeconds) {
            const h = Math.floor(totalSeconds / 3600);
            const m = Math.floor((totalSeconds % 3600) / 60);
            const s = totalSeconds % 60;
            return { h, m, s };
        }

        function generateRandomTime() {
            const minTime = minTimeInput.value || "00:00";
            const maxTime = maxTimeInput.value || "23:59";
            const minSec = timeStrToSeconds(minTime);
            const maxSec = timeStrToSeconds(maxTime);

            // 防止min > max
            let lo = Math.min(minSec, maxSec);
            let hi = Math.max(minSec, maxSec);

            // 在[min, max]范围生成随机整点和整分
            const minutesSpan = Math.floor((hi - lo + 59) / 60);
            const offset = Math.floor(Math.random() * (minutesSpan + 1));
            const randSec = lo + offset * 60;
            const { h, m } = secondsToHMS(randSec);
            // 返回字符串结果
            const randSecWithSeconds = randSec + Math.floor(Math.random() * 60);
            const { h: sh, m: sm, s: ss } = secondsToHMS(randSecWithSeconds);
            return `${padZero(sh)} : ${padZero(sm)} : ${padZero(ss)}`;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // 复制成功可以添加提示
                console.log('已复制:', text);
            }).catch(err => {
                console.error('复制失败:', err);
                // 降级方案：使用传统方法
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                } catch (err) {
                    console.error('降级复制也失败:', err);
                }
                document.body.removeChild(textArea);
            });
        }

        function addTimeResult() {
            const timeStr = generateRandomTime();
            const itemDiv = document.createElement("div");
            itemDiv.className = "time-item";

            const timeText = document.createElement("span");
            timeText.className = "time-text";
            timeText.textContent = timeStr;

            const copyBtn = document.createElement("button");
            copyBtn.className = "copy-btn";
            copyBtn.textContent = "复制";
            copyBtn.onclick = function () {
                copyToClipboard(timeStr);
                // 临时改变按钮文字提示已复制
                const originalText = copyBtn.textContent;
                copyBtn.textContent = "已复制";
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 1000);
            };

            itemDiv.appendChild(timeText);
            itemDiv.appendChild(copyBtn);
            resultArea.appendChild(itemDiv);
        }

        function resetTime() {
            minTimeInput.value = "00:00";
            maxTimeInput.value = "23:59";
        }

        // 生成随机数字（整十，个位是零）
        function generateRandomNumber() {
            const minNum = parseFloat(minNumberInput.value) || 0;
            const maxNum = parseFloat(maxNumberInput.value) || 100;

            // 防止min > max
            const lo = Math.min(minNum, maxNum);
            const hi = Math.max(minNum, maxNum);

            // 向下取整到最近的整十
            const loRounded = Math.floor(lo / 10) * 10;
            const hiRounded = Math.floor(hi / 10) * 10;

            // 计算范围内有多少个整十的数字
            const count = (hiRounded - loRounded) / 10 + 1;

            // 随机选择一个整十的数字
            const randomIndex = Math.floor(Math.random() * count);
            const randomNum = loRounded + randomIndex * 10;

            return randomNum;
        }

        // 添加数字结果到结果区域
        function addNumberResult() {
            const numberStr = generateRandomNumber().toString();
            const itemDiv = document.createElement("div");
            itemDiv.className = "time-item";

            const numberText = document.createElement("span");
            numberText.className = "time-text";
            numberText.textContent = numberStr;

            const copyBtn = document.createElement("button");
            copyBtn.className = "copy-btn";
            copyBtn.textContent = "复制";
            copyBtn.onclick = function () {
                copyToClipboard(numberStr);
                // 临时改变按钮文字提示已复制
                const originalText = copyBtn.textContent;
                copyBtn.textContent = "已复制";
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 1000);
            };

            itemDiv.appendChild(numberText);
            itemDiv.appendChild(copyBtn);
            resultArea.appendChild(itemDiv);
        }

        // 重置数字范围
        function resetNumber() {
            minNumberInput.value = "0";
            maxNumberInput.value = "100";
        }

        // 重置所有结果
        function resetAllResults() {
            resultArea.innerHTML = "";
        }

        randomButton.addEventListener('click', addTimeResult);
        resetButton.addEventListener('click', function () {
            resetTime();
            resetAllResults();
        });
        randomNumberButton.addEventListener('click', addNumberResult);
        resetNumberButton.addEventListener('click', function () {
            resetNumber();
            resetAllResults();
        });

        // 初始化重置
        resetTime();
        resetNumber();
    </script>
</body>

</html>